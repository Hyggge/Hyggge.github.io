<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="「BUAA-CO」P5_流水线cpu（Basic）, Hyggge&#39;s Blog">
    <meta name="description" content="流水线CPU设计方案
设计概述
​		本文所设计的CPU为Verilog实现的流水线MIPS架构CPU，该CPU支持43条MIPS汇编指令，为了实现该功能，笔者设计了IFU，GRF，NPC，CMP，EXT，ALU，DM，D_Reg，E_Re">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>「BUAA-CO」P5_流水线cpu（Basic） | Hyggge&#39;s Blog</title>
    <link rel="icon" type="image/jpeg" href="/medias/avatar.jpg">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Hyggge's Blog" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.svg" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hyggge&#39;s Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Home</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.svg" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hyggge&#39;s Blog</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Home
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/hyggge" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Come On
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/hyggge" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Come On" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/8.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">「BUAA-CO」P5_流水线cpu（Basic）</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">
                                <span class="chip bg-color">计算机组成</span>
                            </a>
                        
                            <a href="/tags/BUAA/">
                                <span class="chip bg-color">BUAA</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/" class="post-category">
                                计算机组成
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-11-15
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.3k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    41 分
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="流水线CPU设计方案">流水线CPU设计方案</h2>
<h3 id="设计概述">设计概述</h3>
<p>​		本文所设计的CPU为Verilog实现的流水线MIPS架构CPU，该CPU支持43条MIPS汇编指令，为了实现该功能，笔者设计了IFU，GRF，NPC，CMP，EXT，ALU，DM，D_Reg，E_Reg，M_Reg，W_Reg，MCU， HCU 等关键模块。整个搭建过程通过自下而上的方式完成——先根据应实现的指令对功能部件进行设计与搭建，然后对各个功能部件进行连接，形成完整的数据通路。</p>
<h3 id="实现指令说明">实现指令说明</h3>
<p>我们将本CPU实现的指令分为以下几类：</p>
<ul>
<li>
<p><strong>calc_R</strong>: addu, subu, and, or, nor, xor, slt, sltu</p>
</li>
<li>
<p><strong>calc_I</strong>: addiu, andi, ori, xori, slti, sltiu</p>
</li>
<li>
<p><strong>shift</strong>: sll, sra, srl</p>
</li>
<li>
<p><strong>shiftv</strong>: sllv, srav, srlv</p>
</li>
<li>
<p><strong>load</strong>: lw, lh, lhu, lb, lbu</p>
</li>
<li>
<p><strong>store</strong>: sw, sh, sb</p>
</li>
<li>
<p><strong>B类</strong>：beq， bne</p>
</li>
<li>
<p><strong>J类</strong>：jal, j</p>
</li>
<li>
<p><strong>特殊</strong>：jr, lui</p>
</li>
</ul>
<hr>
<h2 id="工程模块定义">工程模块定义</h2>
<h3 id="功能模块定义">功能模块定义</h3>
<h4 id="IFU（取指令单元）">IFU（取指令单元）</h4>
<p>​		该模块内部包含PC（程序计数器）和IM（指令存储器）。IM的容量为<strong>16KB</strong>(32bit/word×<strong>4096word</strong>)， 可以根据PC的值从IM取出对应的指令，并具有同步复位的功能。</p>
<ul>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:left">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:left">异步复位信号</td>
</tr>
<tr>
<td style="text-align:center">en</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:left">使能信号(stall信号取反)</td>
</tr>
<tr>
<td style="text-align:center">npc</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:left">下一条要被执行的指令的地址</td>
</tr>
<tr>
<td style="text-align:center">pc</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:left">输出当前正在执行的指令的地址</td>
</tr>
<tr>
<td style="text-align:center">instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:left">输出当前正在执行的指令</td>
</tr>
<tr>
<td style="text-align:center">pc8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:left">pc+8</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>功能定义</strong></p>
<table>
<thead>
<tr>
<th>序号</th>
<th>功能名称</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>复位</td>
<td>当reset信号有效时，将PC寄存器中的值置为0x00003000</td>
</tr>
<tr>
<td>2</td>
<td>停止</td>
<td>当en信号失效时，PC寄存器忽略时钟输入，PC当前值保持不变</td>
</tr>
<tr>
<td>3</td>
<td>写PC寄存器</td>
<td>当en信号失效且时钟上升沿来临时，将下一条指令的地址（next PC）写入PC寄存器</td>
</tr>
<tr>
<td>4</td>
<td>取指令</td>
<td>根据当前pc的值从IM（指令存储器）中读出对应的指令到instr端口</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="GRF（通用寄存器组）">GRF（通用寄存器组）</h4>
<p>​		该模块内部包含32个具有写使能32位寄存器，分别对应MIPS架构中$0 ~ $31通用寄存器（其中0号寄存器中的值恒为0，即不具备写使能，因此为了实现该机制，我们不再设置0号寄存器，每次对0进行特判）。GRF可以实现同步复位，同时可以根据输入的5位地址（0~31）向寄存器堆存取数据，实现定向访存寄存器。</p>
<p>​		为了实现内部转发，我们将当前WD中输入的数据（但没有写入）实时反映到RD1和RD2端口上，用来解决数据冲突。</p>
<ul>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>方向</th>
<th>位宽</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>clk</td>
<td>I</td>
<td>1</td>
<td>时钟信号</td>
</tr>
<tr>
<td>pc</td>
<td>I</td>
<td>32</td>
<td>输出当前正在执行的</td>
</tr>
<tr>
<td>reset</td>
<td>I</td>
<td>1</td>
<td>同步复位信号<br>1：复位信号有效<br>0：复位信号无效</td>
</tr>
<tr>
<td>A1</td>
<td>I</td>
<td>5</td>
<td>地址输入信号，指定32个寄存器中的一个，将其中的数据读出到RD1</td>
</tr>
<tr>
<td>A2</td>
<td>I</td>
<td>5</td>
<td>地址输入信号，指定32个寄存器中的一个，将其中的数据读出到RD2</td>
</tr>
<tr>
<td>A3</td>
<td>I</td>
<td>5</td>
<td>地址输入信号，指定32个寄存器中的一个，将其作为写入目标</td>
</tr>
<tr>
<td>WD</td>
<td>I</td>
<td>32</td>
<td>数据输入信号</td>
</tr>
<tr>
<td>WE</td>
<td>I</td>
<td>1</td>
<td>写使能信号<br>1：写入有效<br>0：写入失效</td>
</tr>
<tr>
<td>RD1</td>
<td>O</td>
<td>32</td>
<td>输出A1指定的寄存器中的32位数据</td>
</tr>
<tr>
<td>RD2</td>
<td>O</td>
<td>32</td>
<td>输出A2指定的寄存器中的32位数据</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>功能定义</strong></p>
<table>
<thead>
<tr>
<th>序号</th>
<th>功能名称</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>复位</td>
<td>reset信号有效时，所有寄存器中储存的值均被清零</td>
</tr>
<tr>
<td>2</td>
<td>读数据</td>
<td>读出A1，A2地址对应的寄存器中储存的数据，将其加载到RD1和RD2</td>
</tr>
<tr>
<td>3</td>
<td>写数据</td>
<td>当WE信号有效且时钟上升沿来临时，将WD中的数据写入到A3地址对应的寄存器</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="NPC（下一指令计算单元）">NPC（下一指令计算单元）</h4>
<p>​		该模块根据当前指令地址和其他控制信号（NPCOp），计算出下一指令所在的地址。</p>
<ul>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>方向</th>
<th>位宽</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>F_pc</td>
<td>I</td>
<td>32</td>
<td>F级指令地址</td>
</tr>
<tr>
<td>D_pc</td>
<td>I</td>
<td>32</td>
<td>D级指令地址</td>
</tr>
<tr>
<td>offset</td>
<td>I</td>
<td>32</td>
<td>地址偏移量，用于计算B类指令所要跳转的地址</td>
</tr>
<tr>
<td>imm26</td>
<td>I</td>
<td>26</td>
<td>当前指令数据的前26位（0~25），用于计算jal和j指令所要跳转的地址</td>
</tr>
<tr>
<td>ra</td>
<td>I</td>
<td>32</td>
<td>储存在寄存器（$ra或是jalr指令中存储“PC+4”的寄存器）中的地址数据，用于实现jr和jalr指令</td>
</tr>
<tr>
<td>judge</td>
<td>I</td>
<td>1</td>
<td>B类指令判断结果<br>1：说明当前B类指令的判断结果为真<br>0：说明判断结果为假</td>
</tr>
<tr>
<td>NPCOp</td>
<td>I</td>
<td>3</td>
<td>NPC功能选择<br>0x000：顺序执行<br>0x001：B类指令分支地址<br>0x010:   jal/j跳转地址<br>0x011:   jr跳转地址</td>
</tr>
<tr>
<td>npc</td>
<td>O</td>
<td>32</td>
<td>输出下一指令地址</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="EXT（扩展单元）">EXT（扩展单元）</h4>
<p>​		该模块对16位立即数进行扩展，可以实现符号扩展，0扩展和加载高位（lui）操作。</p>
<ul>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>方向</th>
<th>位宽</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>in</td>
<td>I</td>
<td>16</td>
<td>16位立即数</td>
</tr>
<tr>
<td>EXTOp</td>
<td>I</td>
<td>2</td>
<td>EXT功能选择信号<br>0x000: 0扩展<br>0x001: 符号扩展<br>0x010: 加载到高位（lui指令使用）</td>
</tr>
<tr>
<td>out</td>
<td>O</td>
<td>32</td>
<td>扩展结果</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="CMP-B类指令比较单元">CMP(B类指令比较单元)</h4>
<p>​		该单元根据输入的CMPOp信号对当前B指令的类型进行判断，进而对当前输入的数值进行相应比较，最后输出结果。</p>
<ul>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>方向</th>
<th>位宽</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>D1</td>
<td>I</td>
<td>32</td>
<td>输入CMP单元的第一个数据</td>
</tr>
<tr>
<td>D1</td>
<td>I</td>
<td>32</td>
<td>输入CMP单元的第二个数据</td>
</tr>
<tr>
<td>CMPOp</td>
<td>I</td>
<td>3</td>
<td>CMPOp功能选择信号<br>0x000：beq判断<br>0x001：bne判断<br>0x010：blez判断<br>0x011:   bgtz判断</td>
</tr>
<tr>
<td>out</td>
<td>O</td>
<td>1</td>
<td>判断结果输出<br>1: 判断结果为真<br>0：判断结果为假</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="ALU（逻辑运算单元）">ALU（逻辑运算单元）</h4>
<p>该模块可实现加，减，按位与，按位或等11种运算，并根据ALUOP信号的值在这些功能中进行选择。除此之外，该模块还可以实现溢出判断。</p>
<ul>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>方向</th>
<th>位宽</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ALUOp</td>
<td>I</td>
<td>4</td>
<td>ALU功能选择信号</td>
</tr>
<tr>
<td>src_A</td>
<td>I</td>
<td>32</td>
<td>参与ALU计算的第一个值</td>
</tr>
<tr>
<td>src_B</td>
<td>I</td>
<td>32</td>
<td>参与ALU计算的第二个值S</td>
</tr>
<tr>
<td>shamt</td>
<td>I</td>
<td>5</td>
<td>移位数输入</td>
</tr>
<tr>
<td>out</td>
<td>O</td>
<td>32</td>
<td>输出ALU计算结果</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>功能定义</strong></p>
<table>
<thead>
<tr>
<th>序号</th>
<th>功能名称</th>
<th>ALU_Op</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>加</td>
<td>0b0000</td>
<td>ALU_Result = Src_A + Src_B</td>
</tr>
<tr>
<td>2</td>
<td>减</td>
<td>0b0001</td>
<td>ALU_Result = Src_A - Src_B</td>
</tr>
<tr>
<td>3</td>
<td>按位与</td>
<td>0b0010</td>
<td>ALU_Result = Src_A &amp; Src_B</td>
</tr>
<tr>
<td>4</td>
<td>按位或</td>
<td>0b0011</td>
<td>ALU_Result = Src_A | Src_B</td>
</tr>
<tr>
<td>5</td>
<td>按位异或</td>
<td>0b0100</td>
<td>ALU_Result = Src_A ⊕ Src_B</td>
</tr>
<tr>
<td>6</td>
<td>按位或非</td>
<td>0b0101</td>
<td>ALU_Result = ~(Src_A | Src_B)</td>
</tr>
<tr>
<td>7</td>
<td>逻辑左移</td>
<td>0b0110</td>
<td>ALU_Result = Src_B &lt;&lt; Shift</td>
</tr>
<tr>
<td>8</td>
<td>逻辑右移</td>
<td>0b0111</td>
<td>ALU_Result = Src_B &gt;&gt; Shift</td>
</tr>
<tr>
<td>9</td>
<td>算术右移</td>
<td>0b1000</td>
<td>ALU_Result = Src_B &gt;&gt;&gt; Shift</td>
</tr>
<tr>
<td>10</td>
<td>带符号比较</td>
<td>0b1001</td>
<td>ALU_Result = (Src_A &gt; Src_B) ? 1 : 0（带符号比较）</td>
</tr>
<tr>
<td>11</td>
<td>无符号比较</td>
<td>0b1010</td>
<td>ALU_Result = (Src_A &gt; Src_B) ? 1 : 0（无符号比较）</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="DM-（数据存储器）">DM （数据存储器）</h4>
<p>​		该模块对数据进行访存，容量为容量为 <strong>12KB</strong>(32bit/word×<strong>3072word</strong>),不仅可以实现对字的访问和存储，还可以实现对半字和字节的操作。</p>
<ul>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>方向</th>
<th>位宽</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>pc</td>
<td>I</td>
<td>32</td>
<td>当前指令地址</td>
</tr>
<tr>
<td>clk</td>
<td>I</td>
<td>1</td>
<td>时钟信号</td>
</tr>
<tr>
<td>reset</td>
<td>I</td>
<td>1</td>
<td>异步复位信号</td>
</tr>
<tr>
<td>A</td>
<td>I</td>
<td>5</td>
<td>地址输入信号，指向数据储存器中某个存储单元</td>
</tr>
<tr>
<td>WD</td>
<td>I</td>
<td>32</td>
<td>数据输入信号</td>
</tr>
<tr>
<td>WE</td>
<td>I</td>
<td>1</td>
<td>写使能信号<br>1：写入有效<br>0：写入失效</td>
</tr>
<tr>
<td>LSOp</td>
<td>I</td>
<td>3</td>
<td>DM访存功能选择信号<br>0x000：lw<br>0x001：lh<br>0x010：lhu<br>0x011：lb<br>0x100：lbu<br>0x101：sw<br>0x110：sh<br>0x111：sb</td>
</tr>
<tr>
<td>RD</td>
<td>O</td>
<td>32</td>
<td>输出A指定的存储单元中的32位数据</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>功能定义</strong></p>
<table>
<thead>
<tr>
<th>序号</th>
<th>功能名称</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>复位</td>
<td>reset信号有效时，所有寄存器中储存的值均被清零</td>
</tr>
<tr>
<td>2</td>
<td>读数据</td>
<td>读出A地址对应的存储单元中的数据，将其加载到RD</td>
</tr>
<tr>
<td>3</td>
<td>写数据</td>
<td>当WE信号有效且时钟上升沿来临时，将WD中的数据写入到A地址对应的存储单元</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="流水寄存器模块定义">流水寄存器模块定义</h3>
<h4 id="D-Reg（IF-ID流水寄存器）">D_Reg（IF/ID流水寄存器）</h4>
<ul>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th>方向</th>
<th>信号名</th>
<th>位宽</th>
<th>描述</th>
<th>输入来源</th>
</tr>
</thead>
<tbody>
<tr>
<td>I</td>
<td>clk</td>
<td>1</td>
<td>时钟信号</td>
<td>mips.v中的clk</td>
</tr>
<tr>
<td>I</td>
<td>reset</td>
<td>1</td>
<td>同步复位信号</td>
<td>mips.v中的reset</td>
</tr>
<tr>
<td>I</td>
<td>en</td>
<td>1</td>
<td>D级寄存器使能信号</td>
<td>HCU中stall信号取反</td>
</tr>
<tr>
<td>I</td>
<td>clr</td>
<td>1</td>
<td>D级寄存器清空信号</td>
<td>默认为1‘b0</td>
</tr>
<tr>
<td>I</td>
<td>F_instr</td>
<td>32</td>
<td>F级instr输入</td>
<td>IFU_instr</td>
</tr>
<tr>
<td>I</td>
<td>F_pc</td>
<td>32</td>
<td>F级pc输入</td>
<td>IFU_pc</td>
</tr>
<tr>
<td>I</td>
<td>F_pc8</td>
<td>32</td>
<td>F级pc8输入</td>
<td>IFU_pc + 8</td>
</tr>
<tr>
<td>O</td>
<td>D_instr</td>
<td>32</td>
<td>D级instr输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>D_pc</td>
<td>32</td>
<td>D级pc输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>D_pc8</td>
<td>32</td>
<td>D级pc8输出</td>
<td></td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="E-Reg（ID-EX流水寄存器）">E_Reg（ID/EX流水寄存器）</h4>
<ul>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th>方向</th>
<th>信号名</th>
<th>位宽</th>
<th>描述</th>
<th>输入来源</th>
</tr>
</thead>
<tbody>
<tr>
<td>I</td>
<td>clk</td>
<td>1</td>
<td>时钟信号</td>
<td>mips.v中的clk</td>
</tr>
<tr>
<td>I</td>
<td>reset</td>
<td>1</td>
<td>同步复位信号</td>
<td>mips.v中的reset</td>
</tr>
<tr>
<td>I</td>
<td>clr</td>
<td>1</td>
<td>E级寄存器清空信号</td>
<td>HCU中stall信号</td>
</tr>
<tr>
<td>I</td>
<td>D_instr_s</td>
<td>5</td>
<td>移位指令的位移数</td>
<td>D_instr的s域数据</td>
</tr>
<tr>
<td>I</td>
<td>D_V1</td>
<td>32</td>
<td>D级V1输入</td>
<td>通过MUX_CMP_D1选择的数据</td>
</tr>
<tr>
<td>I</td>
<td>D_V2</td>
<td>32</td>
<td>D级V2输入</td>
<td>通过MUX_CMP_D1选择的数据</td>
</tr>
<tr>
<td>I</td>
<td>D_A1</td>
<td>5</td>
<td>D级A1输入</td>
<td>D_instr的rs域数据</td>
</tr>
<tr>
<td>I</td>
<td>D_A2</td>
<td>5</td>
<td>D级A2输入</td>
<td>D_instr的rt域数据</td>
</tr>
<tr>
<td>I</td>
<td>D_A3</td>
<td>5</td>
<td>D级A3输入</td>
<td>通过MUX_A3选择出的数据</td>
</tr>
<tr>
<td>I</td>
<td>D_E32</td>
<td>32</td>
<td>D级E32输入</td>
<td>通过EXT模块扩展出的数据</td>
</tr>
<tr>
<td>I</td>
<td>D_pc</td>
<td>32</td>
<td>D级pc输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>D_pc8</td>
<td>32</td>
<td>D级pc输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>Tnew_D</td>
<td>2</td>
<td>D级指令的Tnew输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>RFWrite_D</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>MemWrite_D</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>SelEMOut_D</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>SelWOut_D</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>SelALUS_D</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>SelALUB_D</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>LSOp_D</td>
<td>3</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>ALUOp_D</td>
<td>4</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>O</td>
<td>E_instr_s</td>
<td>5</td>
<td>移位指令的位移数</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>E_V1</td>
<td>32</td>
<td>E级V1输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>E_V2</td>
<td>32</td>
<td>E级V2输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>E_A1</td>
<td>5</td>
<td>E级A1输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>E_A2</td>
<td>5</td>
<td>E级A2输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>E_A3</td>
<td>5</td>
<td>E级A3输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>E_E32</td>
<td>32</td>
<td>E级E32输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>E_pc</td>
<td>32</td>
<td>E级pc输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>E_pc8</td>
<td>32</td>
<td>E级pc输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>Tew_E</td>
<td>2</td>
<td>E级指令的Tnew输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>RFWrite_E</td>
<td>1</td>
<td>E级控制信号输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>MemWrite_E</td>
<td>1</td>
<td>E级控制信号输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>SelEMOut_E</td>
<td>1</td>
<td>E级控制信号输出（使用）</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>SelWOut_E</td>
<td>1</td>
<td>E级控制信号输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>SelALUS_E</td>
<td>1</td>
<td>E级控制信号输出（使用）</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>SelALUB_E</td>
<td>1</td>
<td>E级控制信号输出（使用）</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>LSOp_E</td>
<td>3</td>
<td>E级控制信号输出（使用）</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>ALUOp_E</td>
<td>4</td>
<td>E级控制信号输出</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>运算功能</strong></p>
<p>$Tnew_E = (Tnew_D &gt;   0)   ? Tnew_D - 1: 0$</p>
</li>
</ul>
<h4 id="M-Reg（EX-MEM流水寄存器）">M_Reg（EX/MEM流水寄存器）</h4>
<ul>
<li>
<p>端口定义</p>
<table>
<thead>
<tr>
<th>方向</th>
<th>信号名</th>
<th>位宽</th>
<th>描述</th>
<th>输入来源</th>
</tr>
</thead>
<tbody>
<tr>
<td>I</td>
<td>clk</td>
<td>1</td>
<td>时钟信号</td>
<td>mips.v中的clk</td>
</tr>
<tr>
<td>I</td>
<td>reset</td>
<td>1</td>
<td>同步复位信号</td>
<td>mips.v中的reset</td>
</tr>
<tr>
<td>I</td>
<td>E_AO</td>
<td>32</td>
<td>E级AO输入</td>
<td>ALU_out数据</td>
</tr>
<tr>
<td>I</td>
<td>E_V2</td>
<td>32</td>
<td>E级V2输入</td>
<td>MUX_ALU选择出来的数据</td>
</tr>
<tr>
<td>I</td>
<td>E_A2</td>
<td>32</td>
<td>E级A2输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>E_A3</td>
<td>5</td>
<td>E级A3输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>E_pc</td>
<td>32</td>
<td>E级pc输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>E_pc8</td>
<td>32</td>
<td>E级pc8输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>Tnew_E</td>
<td>2</td>
<td>E级Tnew输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>SelEMOut_E</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>SelWOut_E</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>RFWrite_E</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>MemWrite_E</td>
<td>1</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>LSOp_E</td>
<td>3</td>
<td>D级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>O</td>
<td>M_AO</td>
<td>32</td>
<td>M级AO输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>M_V2</td>
<td>32</td>
<td>M级V2输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>M_A2</td>
<td>32</td>
<td>M级A2输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>M_A3</td>
<td>5</td>
<td>M级A3输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>M_pc</td>
<td>32</td>
<td>M级pc输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>M_pc8</td>
<td>32</td>
<td>M级pc8输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>Tnew_M</td>
<td>2</td>
<td>M级Tnew输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>SelEMOut_M</td>
<td>1</td>
<td>D级控制信号输出（使用）</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>SelWOut_M</td>
<td>1</td>
<td>D级控制信号输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>RFWrite_M</td>
<td>1</td>
<td>D级控制信号输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>MemWrite_M</td>
<td>1</td>
<td>D级控制信号输出（使用）</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>LSOp_M</td>
<td>3</td>
<td>D级控制信号输出（使用）</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>运算功能</strong></p>
<p>$Tnew_M = (Tnew_E &gt;   0)   ? Tnew_E - 1: 0$</p>
</li>
</ul>
<h4 id="W-Reg（MEM-WB流水寄存器）">W_Reg（MEM/WB流水寄存器）</h4>
<ul>
<li>
<p><strong>接口定义</strong></p>
<table>
<thead>
<tr>
<th>方向</th>
<th>信号名</th>
<th>位宽</th>
<th>描述</th>
<th>输入来源</th>
</tr>
</thead>
<tbody>
<tr>
<td>I</td>
<td>clk</td>
<td>1</td>
<td>时钟信号</td>
<td>mips.v中的clk</td>
</tr>
<tr>
<td>I</td>
<td>reset</td>
<td>1</td>
<td>同步复位信号</td>
<td>mips.v中的reset</td>
</tr>
<tr>
<td>I</td>
<td>M_AO</td>
<td>32</td>
<td>M级AO输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>M_DR</td>
<td>32</td>
<td>M级DR输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>M_A3</td>
<td>5</td>
<td>M级A3输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>M_pc</td>
<td>32</td>
<td>M级pc输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>M_pc8</td>
<td>32</td>
<td>M级pc8输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>RFWrite_M</td>
<td>1</td>
<td>M级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>I</td>
<td>SelWOut_M</td>
<td>2</td>
<td>M级控制信号输入</td>
<td>前一级相同信号</td>
</tr>
<tr>
<td>O</td>
<td>W_AO</td>
<td>32</td>
<td>W级AO输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>W_DR</td>
<td>32</td>
<td>W级DR输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>W_A3</td>
<td>5</td>
<td>W级A3输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>W_pc</td>
<td>32</td>
<td>W级pc输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>W_pc8</td>
<td>32</td>
<td>W级pc8输出</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>RFWrite_W</td>
<td>1</td>
<td>W级控制信号输出（使用）</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>SelWOut_W</td>
<td>2</td>
<td>W级控制信号输出（使用）</td>
<td></td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="控制模块定义">控制模块定义</h3>
<h4 id="MCU（主控制器模块）">MCU（主控制器模块）</h4>
<p>​		在主控制模块中，我们对指令中Opcode域和Funct域中的数据进行解码，输出ALUOp,MemtoReg等19条控制指令，从而对数据通路进行调整，满足不同指令的需求。为实现该模块，我们又在内部设计了两个子模块——和逻辑（AND Logic）和或逻辑（OR Logic）。前者的功能是识别，将输入的Opcode和Funct数据识别为对应的指令，后者的功能是生成，根据输入指令的不同产生不同的控制信号。</p>
<ul>
<li>
<p><strong>输入端口定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>方向</th>
<th>位宽</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>opcode</td>
<td>I</td>
<td>6</td>
<td>输入D_instr_opcode域数据</td>
</tr>
<tr>
<td>funt</td>
<td>I</td>
<td>6</td>
<td>输入D_instr_funct域数据</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>输出端口（控制信号）定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>位宽</th>
<th>作用级</th>
<th>描述</th>
<th>相关指令</th>
</tr>
</thead>
<tbody>
<tr>
<td>RFWrite</td>
<td>1</td>
<td>W</td>
<td>GRF写使能信号</td>
<td></td>
</tr>
<tr>
<td>MemWrite</td>
<td>1</td>
<td>M</td>
<td>DM写入使能信号</td>
<td>store型：sw, sb, sh</td>
</tr>
<tr>
<td>SelA3</td>
<td>2</td>
<td>D</td>
<td>对MUX_A3的输出进行选择</td>
<td></td>
</tr>
<tr>
<td>SelEMOut</td>
<td>1</td>
<td>E、M</td>
<td>对MUX_E_out和MUX_M_out的输出进行选择</td>
<td>jr</td>
</tr>
<tr>
<td>SelWOut</td>
<td>2</td>
<td>W</td>
<td>对MUX_W_out的输出进行选择</td>
<td></td>
</tr>
<tr>
<td>SelALUB</td>
<td>1</td>
<td>E</td>
<td>对MUX_ALU_B的输出进行选择</td>
<td></td>
</tr>
<tr>
<td>SelALUS</td>
<td>1</td>
<td>E</td>
<td>对MUX_ALU_S的输出进行选择</td>
<td>shift型、shiftv型</td>
</tr>
<tr>
<td>NPCOp</td>
<td>3</td>
<td>D</td>
<td>NPC模块功能选择信号</td>
<td></td>
</tr>
<tr>
<td>CMPOp</td>
<td>3</td>
<td>D</td>
<td>CMP模块功能选择信号</td>
<td></td>
</tr>
<tr>
<td>EXTOp</td>
<td>2</td>
<td>D</td>
<td>EXT模块功能选择信号</td>
<td></td>
</tr>
<tr>
<td>LSOp</td>
<td>3</td>
<td>M</td>
<td>DM模块功能选择信号</td>
<td></td>
</tr>
<tr>
<td>ALUOp</td>
<td>4</td>
<td>E</td>
<td>ALU模块功能选择信号</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>注：该模块中的“Sel”型信号均作用于功能MUX</p>
</li>
</ul>
<h4 id="HCU（冒险控制器模块）">HCU（冒险控制器模块）</h4>
<p>​		在冒险控制模块中，我们通过对传入的**“A”<strong>（A1，A2，A3）和</strong>“T”**（Tnew，Tuse）进行分析，判断当前需要进行转发（<strong>forward</strong>）还是暂停（<strong>stall</strong>），并通过组合逻辑生成相应控制信号。</p>
<ul>
<li>
<p><strong>输入端口定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>方向</th>
<th>位宽</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>D_A1</td>
<td>I</td>
<td>5</td>
<td>D级A1输入</td>
</tr>
<tr>
<td>D_A2</td>
<td>I</td>
<td>5</td>
<td>D级A2输入</td>
</tr>
<tr>
<td>E_A1</td>
<td>I</td>
<td>5</td>
<td>E级A1输入</td>
</tr>
<tr>
<td>E_A2</td>
<td>I</td>
<td>5</td>
<td>E级A2输入</td>
</tr>
<tr>
<td>M_A2</td>
<td>I</td>
<td>5</td>
<td>M级A2输入</td>
</tr>
<tr>
<td>E_A3</td>
<td>I</td>
<td>5</td>
<td>E级A3输入</td>
</tr>
<tr>
<td>M_A3</td>
<td>I</td>
<td>5</td>
<td>M级A3输入</td>
</tr>
<tr>
<td>W_A3</td>
<td>I</td>
<td>5</td>
<td>W级A3输入</td>
</tr>
<tr>
<td>Tuse_rs</td>
<td>I</td>
<td>2</td>
<td>D级MCU中输出的Tuse_rs信号</td>
</tr>
<tr>
<td>Tuse_rt</td>
<td>I</td>
<td>2</td>
<td>D级MCU中输出的Tuse_rt信号</td>
</tr>
<tr>
<td>Tnew_E</td>
<td>I</td>
<td>2</td>
<td>E级Tnew_E信号输入</td>
</tr>
<tr>
<td>Tnew_M</td>
<td>I</td>
<td>2</td>
<td>M级Tnew_M信号输入</td>
</tr>
<tr>
<td>Tnew_W</td>
<td>I</td>
<td>2</td>
<td>W级Tnew_W信号输入</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>输出端口（控制信号）定义</strong></p>
<table>
<thead>
<tr>
<th>信号名</th>
<th>位宽</th>
<th>作用级</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>FwdCMPD1</td>
<td>2</td>
<td>D</td>
<td>对HMUX_CMP_D1的输出进行选择</td>
</tr>
<tr>
<td>FwdCMPD2</td>
<td>2</td>
<td>D</td>
<td>对HMUX_CMP_D2的输出进行选择</td>
</tr>
<tr>
<td>FwdALUA</td>
<td>2</td>
<td>E</td>
<td>对HMUX_ALU_A的输出进行选择</td>
</tr>
<tr>
<td>FwdALUB</td>
<td>2</td>
<td>E</td>
<td>对HMUX_ALU_B的输出进行选择</td>
</tr>
<tr>
<td>FwdDM</td>
<td>1</td>
<td>M</td>
<td>对HMUX_DM的输出进行选择</td>
</tr>
<tr>
<td>stall</td>
<td>1</td>
<td>F、D、M</td>
<td>暂停信号</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>注：该模块中的“Fwd”型信号均作用于转发MUX</p>
</li>
<li>
<p>注：该模块中的stall信号同时作用与IFU，D_Reg，E_Reg</p>
</li>
</ul>
<h3 id="选择器模块">选择器模块</h3>
<h4 id="功能MUX">功能MUX</h4>
<table>
<thead>
<tr>
<th>MUX名</th>
<th>选择数量</th>
<th>描述</th>
<th>输出信号名</th>
<th>控制信号</th>
</tr>
</thead>
<tbody>
<tr>
<td>MUX_A3</td>
<td>3</td>
<td>D级中A3输入信号进行选择<br>0：D_instr_rt<br>1：D_instr_rd<br>2：0x1f</td>
<td>D_A3</td>
<td>SelA3</td>
</tr>
<tr>
<td>MUX_ALU_B</td>
<td>2</td>
<td>对E级ALU模块src_B接口的信号进行选择<br>0：E_V2_f<br>1：E_E32</td>
<td>ALU_B</td>
<td>SelALUB</td>
</tr>
<tr>
<td>MUX_ALU_S</td>
<td>2</td>
<td>对E级ALU模块src_S接口的信号进行选择<br>0：E_instr_s<br>1：E_V1_f</td>
<td>ALU_S</td>
<td>SelALUS</td>
</tr>
<tr>
<td>MUX_E_out</td>
<td>2</td>
<td>对E级储存的计算结果进行选择<br>0：E_32<br>1：E_pc8</td>
<td>E_out</td>
<td>SelEMOut</td>
</tr>
<tr>
<td>MUX_M_out</td>
<td>2</td>
<td>对M级储存的计算结果进行选择<br>0：M_AO<br>1：M_pc8</td>
<td>M_out</td>
<td>SelEMOut</td>
</tr>
<tr>
<td>MUX_W_out</td>
<td>3</td>
<td>对W级储存的计算结果进行选择<br>0：W_AO<br>1：W_DR<br>2：W_pc8</td>
<td>W_out</td>
<td>SelWOut</td>
</tr>
</tbody>
</table>
<h4 id="转发MUX">转发MUX</h4>
<table>
<thead>
<tr>
<th>MUX名</th>
<th>选择数量</th>
<th>描述</th>
<th>输出信号名</th>
<th>控制信号</th>
</tr>
</thead>
<tbody>
<tr>
<td>HMUX_CMP_D1</td>
<td>3</td>
<td>将数据转发到CMP_D1接口<br>0：GRF_RD1<br>1：M_out<br>2：E_out</td>
<td>D_V1_f</td>
<td>FwdCMPD1</td>
</tr>
<tr>
<td>HMUX_CMP_D2</td>
<td>3</td>
<td>将数据转发到CMP_D2接口<br>0：GRF_RD2<br>1：M_out<br>2：E_out</td>
<td>D_V2_f</td>
<td>FwdCMPD2</td>
</tr>
<tr>
<td>HMUX_ALU_A</td>
<td>3</td>
<td>将数据转发到ALU_A接口<br>0：E_V1<br>1：W_out<br>2：M_out</td>
<td>E_V1_f</td>
<td>FwdALUA</td>
</tr>
<tr>
<td>HMUX_ALU_B</td>
<td>3</td>
<td>将数据转发到ALU_B接口<br>0：E_V2<br>1：W_out<br>2：M_out</td>
<td>E_V2_f</td>
<td>FwdALUB</td>
</tr>
<tr>
<td>HMUX_DM</td>
<td>2</td>
<td>将数据转发到DM_WD接口<br>0：M_V2<br>1：W_out</td>
<td>M_V1_f</td>
<td>FwdDM</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="重要机制实现方法">重要机制实现方法</h2>
<h3 id="分支转移实现">分支转移实现</h3>
<h4 id="B类指令">B类指令</h4>
<p>​		为了减少因控制冲突导致的暂停（<strong>stall</strong>），我们将B类指令的判断进行前置，单独使用CMP模块进行判断。当B类指令进入D级后（此时F级的指令为编译优化调度的指令），CMP模块的判断结果进入NPC，如过CMP结果为真（CMP_out = 1）而且NPCOp信号为0x001（说明当前指令为B类指令），NPC输出转移的地址npc并进入IFU的输入端，在下一时钟沿上升时进入F级，实现转移。</p>
<h4 id="j和jal">j和jal</h4>
<p>​		当j或jal进入D级后（此时F级的指令为编译优化调度的指令），D_instr中imm26域的数据进入NPC进行处理，如果当前NPCOp信号为0x010（说明当前指令为jal或j指令），NPC输出转移的地址npc，并进入IFU的输入端，在下一时钟沿上升时进入F级，实现转移。</p>
<p>​		jal指令在实现跳转的同时，还需要将下一条指令的地址存入31号寄存器中，因此我们需要在IFU中计算出改地址，并随着jal指令进行流水，最终在W级写入GRF的31号寄存器。由于存在延迟槽，pc+4地址中的指令是编译优化机制调度过来的，因此我们要保存的地址应该为pc+8。</p>
<h4 id="jr">jr</h4>
<p>​		当jr进入D级后（此时F级的指令为编译优化调度的指令），D_V1_f（经过转发后的D_V1值）进入NPC，如果当前NPCOp信号为0x011（说明当前指令为jr指令），NPC输出转移的地址npc，并进入IFU的输入端，在下一时钟沿上升时进入F级，实现转移。</p>
<h3 id="冒险处理">冒险处理</h3>
<p>冒险处理我们均通过“A_T”法实现——</p>
<h4 id="转发（forward）">转发（forward）</h4>
<p>​		当前面的指令要写寄存器但还未写入，而后面的指令需要用到没有被写入的值时，这时候会产生<strong>数据冒险</strong>，我们首先考虑进行转发。我们<strong>假设所有的数据冒险均可通过转发解决</strong>。也就是说，当某一指令前进到必须使用某一寄存器的值的流水阶段时，这个寄存器的值一定已经产生，并<strong>存储于后续某个流水线寄存器中</strong>。</p>
<p>​		在这一阶段，我们不管需要的值有没由计算出，都要进行转发，即暴力转发。为实现这一机制，我们要清楚哪些模块需要转发后的数据（<strong>需求者</strong>）和保存着写入值的流水寄存器（<strong>供应者</strong>）</p>
<ul>
<li>
<p><strong>供应者及其产生的数据</strong></p>
<table>
<thead>
<tr>
<th>流水级</th>
<th>产生数据</th>
<th>MUX名&amp;选择信号名</th>
<th>MUX输出名</th>
</tr>
</thead>
<tbody>
<tr>
<td>E</td>
<td>E_E32，E_pc8</td>
<td>MUX_E_out  &amp;  SelEMOut</td>
<td>E_out</td>
</tr>
<tr>
<td>M</td>
<td>M_AO，M_pc8</td>
<td>MUX_M_out  &amp;  SelEMOut</td>
<td>M_out</td>
</tr>
<tr>
<td>W</td>
<td>W_AO，W_RD，W_pc8</td>
<td>MUX_W_out  &amp;  SelWOut</td>
<td>W_out</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>需求者及其产生的数据</strong></p>
<table>
<thead>
<tr>
<th>接收端口</th>
<th>选择数据</th>
<th>HMUX名&amp;选择信号名</th>
<th>MUX输出名</th>
</tr>
</thead>
<tbody>
<tr>
<td>CMP_D1/NPC_ra</td>
<td>D_V1，M_out，E_out</td>
<td>HMUX_CMP_D1  &amp;  FwdCMPD1</td>
<td>D_V1_f</td>
</tr>
<tr>
<td>CMP_D2</td>
<td>D_v1，M_out，E_out</td>
<td>HMUX_CMP_D2  &amp;  FwdCMPD2</td>
<td>D_V2_f</td>
</tr>
<tr>
<td>ALU_A</td>
<td>E_V1， W_out，M_out</td>
<td>HMUX_ALU_A  &amp;  FwdALUA</td>
<td>E_V1_f</td>
</tr>
<tr>
<td>ALU_B</td>
<td>E_V2，W_out，M_out</td>
<td>HMUX_ALU_B  &amp;  FwdALUB</td>
<td>E_V1_f</td>
</tr>
<tr>
<td>DM_WD</td>
<td>M_V2， W_out</td>
<td>HMUX_DM  &amp;  FwdDM</td>
<td>M_V2_f</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>​		从上表可以看出，W级中的数据没有转发到D级，原因是我们在GRF内实现了内部转发机制，将GRF输入端的数据（还未写入）及时反映到RD1或这RD2，判断条件为<code>A3 ==  A2 </code>或者<code>A3 == A1</code>。</p>
<p>​		此时为了生成HMUX的选择信号，我们需要向HCU（冒险控制器）输入”A”数据，然后进行选择信号的计算，执行转发的条件为——</p>
<ul>
<li><strong>前位点的读取寄存器地址和某转发输入来源的写入寄存器地址相等且不为 0</strong></li>
<li><strong>写使能信号有效</strong></li>
</ul>
<p>​	根据以上条件我们可以生成上面的5个HMUX选择信号，选择信号的输出值应遵循“就近原则”，及最先产生的数据最先被转发。</p>
<h4 id="暂停（stall）">暂停（stall）</h4>
<p>​		接下来，我们来处理通过转发不能处理的数据冒险。在这种情况下，新的数据还未来得及产生。我们只能暂停流水线，等待新的数据产生。为了方便处理，我们仅仅为D级的指令进行暂停处理。</p>
<p>​		我们把Tuse和Tnew作为暂停的判断依据——</p>
<ul>
<li>Tuse：指令进入 <strong>D 级</strong>后，其后的某个功能部件<strong>再</strong>经过多少时钟周期就<strong>必须</strong>要使用寄存器值。对于有两个操作数的指令，其<strong>每个操作数的 Tuse 值可能不等</strong>（如 store 型指令 rs、rt 的 Tuse 分别为 1 和 2 ）。</li>
<li>Tnew：位于 <strong>E 级及其后各级</strong>的指令，再经过多少周期就能够产生要写入寄存器的结果。在我们目前的 CPU 中，W 级的指令Tnew 恒为 0；对于同一条指令，Tnew@M = max(Tnew@E - 1, 0)</li>
</ul>
<p>​		在这一阶段，我们找到D级生成的Tuse_rs和Tuse_rt和在E,M,W级寄存器中流水的Tnew_D，Tnew_M，Tnew_W，如下表所示</p>
<ul>
<li>
<p><strong>Tuse表</strong></p>
<table>
<thead>
<tr>
<th>指令类型</th>
<th>Tuse_rs</th>
<th>Tuse_rt</th>
</tr>
</thead>
<tbody>
<tr>
<td>calc_R</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>calc_I</td>
<td>1</td>
<td>X</td>
</tr>
<tr>
<td>shift</td>
<td>X</td>
<td>1</td>
</tr>
<tr>
<td>shiftv</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>load</td>
<td>1</td>
<td>X</td>
</tr>
<tr>
<td>store</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>branch</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>jump</td>
<td>X</td>
<td>X</td>
</tr>
<tr>
<td>jr</td>
<td>0</td>
<td>X</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Tnew表</strong></p>
<table>
<thead>
<tr>
<th>指令类型</th>
<th>Tnew_D</th>
<th>Tnew_E</th>
<th>Tnew_M</th>
<th>Tnew_W</th>
</tr>
</thead>
<tbody>
<tr>
<td>calc_R</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>calc_I</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>shift</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>shiftv</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>load</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>store</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
</tr>
<tr>
<td>branch</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
</tr>
<tr>
<td>jal</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>jr</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
</tr>
<tr>
<td>lui</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>​		然后我们Tnew和Tuse传入HCU（冒险控制器中），然后进行stall信号的计算。如果Tnew &gt; TuseHCU中的stall信号值为1，此时执行以下操作——</p>
<ul>
<li><strong>冻结PC寄存器（IFU_en = ~stall = 0）</strong></li>
<li><strong>冻结D级寄存器（D_en = ~stall = 0）</strong></li>
<li><strong>清空E级寄存器（E_clr = stall = 1）</strong></li>
</ul>
<hr>
<h2 id="测试方案">测试方案</h2>
<h3 id="典型测试样例">典型测试样例</h3>
<h4 id="运算指令测试">运算指令测试</h4>
<p>该部分测试通过随机数随机生成，以保证测试数据的任意性，然后与同学代码进行对拍，以确定正确性。（随机生成程序与对拍程序均由同学设计）<br>
其中一组测试数据如下所示</p>
  <pre class="line-numbers language-verilog" data-language="verilog"><code class="language-verilog">li <span class="token kernel-function property">$0</span> <span class="token number">1856279938</span>
li <span class="token kernel-function property">$1</span> <span class="token number">1934446801</span>
li <span class="token kernel-function property">$2</span> <span class="token operator">-</span><span class="token number">1722438048</span>
li <span class="token kernel-function property">$3</span> <span class="token operator">-</span><span class="token number">1916920114</span>
li <span class="token kernel-function property">$4</span> <span class="token number">661049635</span>
li <span class="token kernel-function property">$5</span> <span class="token operator">-</span><span class="token number">1673451598</span>
li <span class="token kernel-function property">$6</span> <span class="token number">494171713</span>
li <span class="token kernel-function property">$7</span> <span class="token number">1395838457</span>
li  <span class="token kernel-function property">$7</span> <span class="token number">0</span>
li  <span class="token kernel-function property">$4</span> <span class="token number">0</span>
li  <span class="token kernel-function property">$3</span> <span class="token number">0</span>
subu <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span>
sltu <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span>
slt <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span>
<span class="token keyword">xor</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span>
<span class="token keyword">xor</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span>
<span class="token keyword">xor</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span>
subu <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span>
addu <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span>
slt <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span>
sltu <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span>
srav <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span>
<span class="token keyword">xor</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span>
<span class="token keyword">xor</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span>
sltu <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span>
sltu <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span>
srlv <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span>
slt <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span>
subu <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span>
srav <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span>
sllv <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span>
andi <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token number">4839</span>
lui <span class="token kernel-function property">$0</span><span class="token punctuation">,</span><span class="token number">50410</span>
lui <span class="token kernel-function property">$7</span><span class="token punctuation">,</span><span class="token number">37950</span>
slti <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">27385</span>
sltiu <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">25736</span>
xori <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">21063</span>
addiu <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">13980</span>
sltiu <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3696</span>
andi <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9134</span>
xori <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6255</span>
andi <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token number">16257</span>
andi <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">11820</span>
slti <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token number">27643</span>
sltiu <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">28474</span>
addiu <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token number">27095</span>
slti <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">28162</span>
slti <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">21601</span>
sltiu <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token number">8945</span>
ori <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token number">6182</span>
andi <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token number">50</span>
sw <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token function">2248</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lbu <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token function">1490</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sb <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token function">2357</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lw <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token function">304</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lb <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token function">797</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lhu <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token function">3380</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token function">2036</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lhu <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token function">3090</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lw <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token function">2144</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lh <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token function">1386</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sh <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token function">1450</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lh <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token function">178</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token function">2184</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lh <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token function">3686</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lh <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token function">784</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lb <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token function">1856</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lhu <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token function">2054</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sh <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token function">2672</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lbu <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token function">144</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lhu <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token function">1898</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sll <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token number">0</span>
srl <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">2</span>
sll <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token number">5</span>
sll <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token number">7</span>
sra <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">7</span>
sra <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">3</span>
sra <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token number">6</span>
srl <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token number">6</span>
sll <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token number">4</span>
srl <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token number">6</span>
sll <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token number">2</span>
sll <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token number">1</span>
sra <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token number">5</span>
sra <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token number">7</span>
sll <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token number">2</span>
srl <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token number">0</span>
sra <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token number">6</span>
sra <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token number">4</span>
sra <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token number">5</span>
sra <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">5</span>

li  <span class="token kernel-function property">$2</span> <span class="token number">0</span>
li  <span class="token kernel-function property">$3</span> <span class="token number">0</span>
li  <span class="token kernel-function property">$5</span> <span class="token number">0</span>

b_test_1_one<span class="token punctuation">:</span>
bne <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> b_test_1_one_then
<span class="token keyword">or</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span>
b_test_1_two<span class="token punctuation">:</span>
beq <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> b_test_1_two_then
lui <span class="token kernel-function property">$1</span><span class="token punctuation">,</span><span class="token number">33465</span>
jal_test_1<span class="token punctuation">:</span>
jal jal_test_1_then
lui <span class="token kernel-function property">$5</span><span class="token punctuation">,</span><span class="token number">28752</span>
end_1<span class="token punctuation">:</span>

srav <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span>
xori <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4086</span>
sb <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token function">1959</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sll <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token number">5</span>

……………………………………………………

b_test_10_one<span class="token punctuation">:</span>
bne <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> b_test_10_one_then
sllv <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span>
b_test_10_two<span class="token punctuation">:</span>
blez <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> b_test_10_two_then
addiu <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token number">24630</span>
jal_test_10<span class="token punctuation">:</span>
jal jal_test_10_then
andi <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2262</span>
end_10<span class="token punctuation">:</span>

<span class="token keyword">and</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span>
sltiu <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10971</span>
lhu <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token function">3654</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
srl <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token number">6</span>
j   <span class="token keyword">final</span>



<span class="token comment">//</span>
b_test_1_one_then<span class="token punctuation">:</span>
<span class="token keyword">nor</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span>
ori <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token number">25634</span>
sw <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token function">3824</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
srl <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token number">2</span>
j b_test_1_two
<span class="token keyword">and</span> <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span>

b_test_1_two_then<span class="token punctuation">:</span>
<span class="token keyword">or</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span>
andi <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">31499</span>
sw <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token function">2876</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sll <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token number">6</span>
jal jal_test_1
addu <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$ra</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span>

jal_test_1_then<span class="token punctuation">:</span>
sllv <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span>
sltiu <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token number">21590</span>
lh <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token function">3136</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sra <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">2</span>
addiu <span class="token kernel-function property">$ra</span><span class="token punctuation">,</span><span class="token kernel-function property">$ra</span><span class="token punctuation">,</span> <span class="token number">8</span>
blez <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> end_1
sllv <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span>
ori <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">28484</span>
lb <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token function">1030</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sll <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token number">7</span>
jr <span class="token kernel-function property">$ra</span>

…………………………………………

b_test_10_one_then<span class="token punctuation">:</span>
sltu <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span>
addiu <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token number">3346</span>
sh <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token function">2950</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
srl <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token number">1</span>
j b_test_10_two
slt <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span>

b_test_10_two_then<span class="token punctuation">:</span>
<span class="token keyword">xor</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span>
slti <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">16048</span>
lh <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token function">146</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sra <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token number">6</span>
jal jal_test_10
addu <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$ra</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span>

jal_test_10_then<span class="token punctuation">:</span>
srav <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span>
lui <span class="token kernel-function property">$6</span><span class="token punctuation">,</span><span class="token number">58558</span>
lbu <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token function">3162</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sll <span class="token kernel-function property">$1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> <span class="token number">2</span>
addiu <span class="token kernel-function property">$ra</span><span class="token punctuation">,</span><span class="token kernel-function property">$ra</span><span class="token punctuation">,</span> <span class="token number">8</span>
bgtz <span class="token kernel-function property">$7</span><span class="token punctuation">,</span> end_10
<span class="token keyword">or</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$5</span>
addiu <span class="token kernel-function property">$3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token number">16811</span>
lb <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token function">4069</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sll <span class="token kernel-function property">$6</span><span class="token punctuation">,</span> <span class="token kernel-function property">$2</span><span class="token punctuation">,</span> <span class="token number">0</span>
jr <span class="token kernel-function property">$ra</span>
<span class="token keyword">final</span><span class="token punctuation">:</span>
nop
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="转移指令（B类和J类）测试">转移指令（B类和J类）测试</h4>
<pre class="line-numbers language-verilog" data-language="verilog"><code class="language-verilog">main<span class="token punctuation">:</span>	
li	<span class="token kernel-function property">$s0</span><span class="token punctuation">,</span> <span class="token number">0</span>
li	<span class="token kernel-function property">$s1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1000</span>
li	<span class="token kernel-function property">$s2</span><span class="token punctuation">,</span> <span class="token number">1000</span>
lui	<span class="token kernel-function property">$s3</span><span class="token punctuation">,</span> <span class="token number">0</span>x8000	#s3 is  <span class="token operator">-</span><span class="token number">2147483648</span>
lui	<span class="token kernel-function property">$s4</span><span class="token punctuation">,</span> <span class="token number">0</span>x8000
ori	<span class="token kernel-function property">$s4</span><span class="token punctuation">,</span> <span class="token number">0</span>x0001	#s4 is  <span class="token operator">-</span><span class="token number">2147483647</span>
lui	<span class="token kernel-function property">$s5</span><span class="token punctuation">,</span> <span class="token number">0</span>x7fff
ori	<span class="token kernel-function property">$s5</span><span class="token punctuation">,</span> <span class="token number">0</span>xffff	#s5 is  <span class="token number">2147483647</span>
lui	<span class="token kernel-function property">$s6</span><span class="token punctuation">,</span> <span class="token number">0</span>x7fff
ori	<span class="token kernel-function property">$s6</span><span class="token punctuation">,</span> <span class="token number">0</span>xfffe	#s6 is <span class="token number">2147483646</span>


beq_1<span class="token punctuation">:</span>	beq	<span class="token kernel-function property">$s0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$s0</span><span class="token punctuation">,</span> beq_1_test
		nop
beq_2<span class="token punctuation">:</span>	beq	<span class="token kernel-function property">$s1</span><span class="token punctuation">,</span> <span class="token kernel-function property">$s1</span><span class="token punctuation">,</span> beq_2_test
		nop
……
beq_10<span class="token punctuation">:</span>  beq	<span class="token kernel-function property">$s5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$s6</span><span class="token punctuation">,</span> beq_10_test
		nop
beq_end<span class="token punctuation">:</span>

bne_1<span class="token punctuation">:</span>	bne	<span class="token kernel-function property">$s0</span><span class="token punctuation">,</span> <span class="token kernel-function property">$s1</span><span class="token punctuation">,</span> bne_1_test
		nop
……
bne_10<span class="token punctuation">:</span>	bne	<span class="token kernel-function property">$s3</span><span class="token punctuation">,</span> <span class="token kernel-function property">$s3</span><span class="token punctuation">,</span> bne_10_test
		nop
bne_end<span class="token punctuation">:</span>

blez_1<span class="token punctuation">:</span> blez	<span class="token kernel-function property">$s0</span><span class="token punctuation">,</span> blez_1_test
		nop
……
blez_10<span class="token punctuation">:</span> blez	<span class="token kernel-function property">$s6</span><span class="token punctuation">,</span> blez_10_test
		nop
blez_end<span class="token punctuation">:</span>

bgtz_1<span class="token punctuation">:</span>	 bgtz	<span class="token kernel-function property">$s2</span><span class="token punctuation">,</span>bgtz_1_test
		nop
……
bgtz_10<span class="token punctuation">:</span> bgtz	<span class="token kernel-function property">$s1</span><span class="token punctuation">,</span>bgtz_10_test
		nop
bgtz_end<span class="token punctuation">:</span>

jal_1<span class="token punctuation">:</span>	jal	jal_1_test
		nop
……
jal_5<span class="token punctuation">:</span>	jal	jal_5_test
		nop
jal_end<span class="token punctuation">:</span>

sw	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">0</span><span class="token punctuation">(</span><span class="token kernel-function property">$s0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token function">0</span><span class="token punctuation">(</span><span class="token kernel-function property">$s0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token function">0</span><span class="token punctuation">(</span><span class="token kernel-function property">$s0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span> <span class="token function">0</span><span class="token punctuation">(</span><span class="token kernel-function property">$s0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t4</span><span class="token punctuation">,</span> <span class="token function">0</span><span class="token punctuation">(</span><span class="token kernel-function property">$s0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t5</span><span class="token punctuation">,</span> <span class="token function">0</span><span class="token punctuation">(</span><span class="token kernel-function property">$s0</span><span class="token punctuation">)</span>
li	<span class="token kernel-function property">$v0</span><span class="token punctuation">,</span> <span class="token number">10</span>
syscall
	
beq_1_test<span class="token punctuation">:</span> addi	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span><span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token number">1</span>
	   j	beq_2
		nop
……
beq_10_test<span class="token punctuation">:</span> addi	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span><span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token number">1</span>
	   j	beq_end
		nop

bne_1_test<span class="token punctuation">:</span> addi	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span><span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token number">1</span>
	   j	bne_2
		nop
……
bne_10_test<span class="token punctuation">:</span>addi	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span><span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token number">1</span>
	   j	bne_end
		nop

blez_1_test<span class="token punctuation">:</span>	addi	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span><span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token number">1</span>
		j	blez_2
		nop
……
blez_10_test<span class="token punctuation">:</span>	addi	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span><span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token number">1</span>
		j	blez_end
		nop

bgtz_1_test<span class="token punctuation">:</span>	addi	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span><span class="token kernel-function property">$t3</span> <span class="token number">1</span>
		j	bgtz_2
		nop
……
bgtz_10_test<span class="token punctuation">:</span>	addi	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span><span class="token kernel-function property">$t3</span> <span class="token number">1</span>
		j	bgtz_end
		nop
		
jal_1_test<span class="token punctuation">:</span>	addi	<span class="token kernel-function property">$t4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token number">1</span>
		jr	<span class="token kernel-function property">$ra</span>
		nop
……
jal_5_test<span class="token punctuation">:</span>	addi	<span class="token kernel-function property">$t4</span><span class="token punctuation">,</span> <span class="token kernel-function property">$4</span><span class="token punctuation">,</span> <span class="token number">1</span>
		jr	<span class="token kernel-function property">$ra</span>
		nop

jalr_1_test<span class="token punctuation">:</span>	addi	<span class="token kernel-function property">$t5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$t5</span><span class="token punctuation">,</span> <span class="token number">1</span>
		jr	<span class="token kernel-function property">$v1</span>
		nop
……
jalr_5_test<span class="token punctuation">:</span>	addi	<span class="token kernel-function property">$t5</span><span class="token punctuation">,</span> <span class="token kernel-function property">$t5</span><span class="token punctuation">,</span> <span class="token number">1</span>
		jr	<span class="token kernel-function property">$v1</span>
		nop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="访存指令测试">访存指令测试</h4>
<pre class="line-numbers language-verilog" data-language="verilog"><code class="language-verilog"><span class="token punctuation">.</span>text

li	<span class="token kernel-function property">$s0</span><span class="token punctuation">,</span> <span class="token number">0</span>xABCF1234
li	<span class="token kernel-function property">$s1</span><span class="token punctuation">,</span> <span class="token number">0</span>x1234ABCD
li	<span class="token kernel-function property">$s2</span><span class="token punctuation">,</span> <span class="token number">0</span>xa1b2c3d4
li	<span class="token kernel-function property">$s3</span><span class="token punctuation">,</span> <span class="token number">0</span>x7fff0000

sb	<span class="token kernel-function property">$s1</span><span class="token punctuation">,</span> <span class="token function">100</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sb	<span class="token kernel-function property">$s2</span><span class="token punctuation">,</span> <span class="token function">103</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sb	<span class="token kernel-function property">$s3</span><span class="token punctuation">,</span> <span class="token function">105</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sb	<span class="token kernel-function property">$s4</span><span class="token punctuation">,</span> <span class="token function">107</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sh	<span class="token kernel-function property">$s4</span><span class="token punctuation">,</span> <span class="token function">108</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sh	<span class="token kernel-function property">$s3</span><span class="token punctuation">,</span> <span class="token function">110</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sh	<span class="token kernel-function property">$s2</span><span class="token punctuation">,</span> <span class="token function">112</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sh	<span class="token kernel-function property">$s1</span><span class="token punctuation">,</span> <span class="token function">114</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$s0</span><span class="token punctuation">,</span> <span class="token function">0</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$s1</span><span class="token punctuation">,</span> <span class="token function">4</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$s2</span><span class="token punctuation">,</span> <span class="token function">8</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$s3</span><span class="token punctuation">,</span> <span class="token function">12</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lw	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">0</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lw	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token function">4</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lw	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token function">8</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lw	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span> <span class="token function">12</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">16</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token function">20</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token function">24</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span> <span class="token function">28</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lb	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">3</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lb	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token function">7</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lb	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token function">11</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lb	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span> <span class="token function">13</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">32</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token function">36</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token function">40</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span> <span class="token function">44</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lbu	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">3</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lbu	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token function">7</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lbu	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token function">11</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lbu	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span> <span class="token function">13</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">48</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token function">52</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token function">56</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span> <span class="token function">60</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lh	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">2</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lh	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">4</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lh	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">8</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lh	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">12</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">64</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token function">68</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token function">72</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span> <span class="token function">76</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lhu	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">2</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lhu	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">6</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lhu	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">8</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
lhu	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">12</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t0</span><span class="token punctuation">,</span> <span class="token function">80</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t1</span><span class="token punctuation">,</span> <span class="token function">84</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t2</span><span class="token punctuation">,</span> <span class="token function">88</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
sw	<span class="token kernel-function property">$t3</span><span class="token punctuation">,</span> <span class="token function">92</span><span class="token punctuation">(</span><span class="token kernel-function property">$0</span><span class="token punctuation">)</span>
li	<span class="token kernel-function property">$v0</span><span class="token punctuation">,</span> <span class="token number">10</span>
syscall<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="自动测试工具">自动测试工具</h3>
<ul>
<li>
<p><strong>测试代码生成工具（python）</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">  
  <span class="token keyword">import</span> random
  
  list_R <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"addu"</span><span class="token punctuation">,</span> <span class="token string">"subu"</span><span class="token punctuation">,</span> <span class="token string">"and"</span><span class="token punctuation">,</span> <span class="token string">"or"</span><span class="token punctuation">,</span> <span class="token string">"nor"</span><span class="token punctuation">,</span> <span class="token string">"xor"</span><span class="token punctuation">,</span> <span class="token string">"sltu"</span><span class="token punctuation">,</span> <span class="token string">"slt"</span><span class="token punctuation">,</span> <span class="token string">"sllv"</span><span class="token punctuation">,</span> <span class="token string">"srlv"</span><span class="token punctuation">,</span> <span class="token string">"srav"</span><span class="token punctuation">]</span>
  list_I <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"andi"</span><span class="token punctuation">,</span> <span class="token string">"addiu"</span><span class="token punctuation">,</span> <span class="token string">"ori"</span><span class="token punctuation">,</span> <span class="token string">"xori"</span><span class="token punctuation">,</span> <span class="token string">"lui"</span><span class="token punctuation">,</span> <span class="token string">"slti"</span><span class="token punctuation">,</span> <span class="token string">"sltiu"</span><span class="token punctuation">]</span>
  list_LS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"lw"</span><span class="token punctuation">,</span> <span class="token string">"sw"</span><span class="token punctuation">,</span> <span class="token string">"lh"</span><span class="token punctuation">,</span> <span class="token string">"lhu"</span><span class="token punctuation">,</span> <span class="token string">"sh"</span><span class="token punctuation">,</span> <span class="token string">"lb"</span><span class="token punctuation">,</span> <span class="token string">"lbu"</span><span class="token punctuation">,</span> <span class="token string">"sb"</span><span class="token punctuation">]</span>
  list_shift <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"sll"</span><span class="token punctuation">,</span> <span class="token string">"srl"</span><span class="token punctuation">,</span> <span class="token string">"sra"</span><span class="token punctuation">]</span>
  list_B <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"bne"</span><span class="token punctuation">,</span> <span class="token string">"beq"</span><span class="token punctuation">]</span>
  
  
  <span class="token keyword">def</span> <span class="token function">R_test</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
          k <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_R<span class="token punctuation">)</span>
          rs <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span>
          rt <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span>
          rd <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span>
          s <span class="token operator">=</span> <span class="token string">"{} ${}, ${}, ${}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>list_R<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> rd<span class="token punctuation">,</span> rs<span class="token punctuation">,</span> rt<span class="token punctuation">)</span>
          <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
  
  <span class="token keyword">def</span> <span class="token function">I_test</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
          k <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_I<span class="token punctuation">)</span>
          rs <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
          rt <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
          imm <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">32768</span><span class="token punctuation">,</span> <span class="token number">32768</span><span class="token punctuation">)</span>
          abs_imm <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">65536</span><span class="token punctuation">)</span>
          <span class="token keyword">if</span> list_I<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"lui"</span><span class="token punctuation">:</span>
              s <span class="token operator">=</span> <span class="token string">"{} ${},{}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>list_I<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> rt<span class="token punctuation">,</span> abs_imm<span class="token punctuation">)</span>
          <span class="token keyword">else</span><span class="token punctuation">:</span>
              s <span class="token operator">=</span> <span class="token string">"{} ${}, ${}, {}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>list_I<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> rt<span class="token punctuation">,</span> rs<span class="token punctuation">,</span> imm<span class="token punctuation">)</span>
          <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
  
  <span class="token keyword">def</span> <span class="token function">LS_test</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
          k <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_LS<span class="token punctuation">)</span>
          ins <span class="token operator">=</span> list_LS<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
          num <span class="token operator">=</span> <span class="token number">0</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>ins<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
              num <span class="token operator">=</span> <span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4096</span>
          <span class="token keyword">elif</span><span class="token punctuation">(</span>ins<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"h"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
              num <span class="token operator">=</span> <span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4096</span>
          <span class="token keyword">else</span><span class="token punctuation">:</span>
              num <span class="token operator">=</span> <span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4096</span>
          
          rt <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
          s <span class="token operator">=</span> <span class="token string">"{} ${}, {}($0)\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span> rt<span class="token punctuation">,</span> num<span class="token punctuation">)</span>
          <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
  
  <span class="token keyword">def</span> <span class="token function">shift_test</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
          k <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_shift<span class="token punctuation">)</span>
          shamt <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
          rd <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
          rt <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
          s <span class="token operator">=</span> <span class="token string">"{} ${}, ${}, {}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>list_shift<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> rd<span class="token punctuation">,</span> rt<span class="token punctuation">,</span> shamt<span class="token punctuation">)</span>
          <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
  
  <span class="token keyword">def</span> <span class="token function">B_test</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> lable<span class="token punctuation">)</span><span class="token punctuation">:</span>
      k <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_B<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">or</span> k <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
          rs <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
          rt <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
          s <span class="token operator">=</span> <span class="token string">"{} ${}, ${}, {}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>list_B<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> rs<span class="token punctuation">,</span> rt<span class="token punctuation">,</span> lable<span class="token punctuation">)</span>
          <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
      <span class="token keyword">else</span><span class="token punctuation">:</span>
          rs <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
          s <span class="token operator">=</span> <span class="token string">"{} ${}, {}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>list_B<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> rs<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lable<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
  
  <span class="token keyword">def</span> <span class="token function">b_begin</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\nb_test_{}_one:\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      B_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">"b_test_{}_one_then"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      R_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
  
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"b_test_{}_two:\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      B_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">"b_test_{}_two_then"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      I_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
  
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"jal_test_{}:\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"jal jal_test_{}_then\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      I_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
  
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"end_{}:\n\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
  
      R_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      I_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      LS_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      shift_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  
  <span class="token keyword">def</span> <span class="token function">b_end</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\nb_test_{}_one_then:\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      R_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      I_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      LS_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      shift_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"j b_test_{}_two\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      R_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\nb_test_{}_two_then:\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      R_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      I_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      LS_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      shift_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"jal jal_test_{}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"addu $1, $ra, $0\n"</span><span class="token punctuation">)</span>
  
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\njal_test_{}_then:\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      R_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      I_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      LS_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      shift_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"addiu $ra,$ra, 8\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      B_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">"end_{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
      R_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      I_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      LS_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      shift_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"jr $ra\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
  
  
  <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"mips_code.asm"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
          temp <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2147483648</span><span class="token punctuation">,</span> <span class="token number">2147483648</span><span class="token punctuation">)</span>
          s <span class="token operator">=</span> <span class="token string">"li ${} {}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> temp<span class="token punctuation">)</span>
          <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
      
      index <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"li  ${} 0\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>
      index <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"li  ${} 0\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>
      index <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"li  ${} 0\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>
  
      R_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
      I_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
      LS_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
      shift_test<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
  
      index <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"li  ${} 0\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>
      index <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"li  ${} 0\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>
      index <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"li  ${} 0\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>
  
      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
          b_begin<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"j   final\n"</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
          b_end<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">+</span>i<span class="token punctuation">)</span>
      <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"final:\n"</span><span class="token punctuation">)</span>

<span class="token operator">-</span> 自动测试工具（python）

  在使用前，我们需要将下方r_road和xilinx_path中输入工程文件夹路径和ISE路径。在终端运行这个代码（test<span class="token punctuation">.</span>py）后，首先需要输入测试次数，对于每一次测试，我们运行一次代码自动生成工具（generate_2<span class="token punctuation">.</span>py）<span class="token punctuation">,</span>生成MIPS代码（mips_code<span class="token punctuation">.</span>asm）<span class="token punctuation">,</span>然后会启动mars和ISE分别获得标准输出和测试输出，最后进行文本比较。如果出现错误，会自动生成错误日志文件，显示错误行数和相应mips机器码、标准输出、测试输出。如果想要对自己写的MIPS代码进行测试，只需要将第<span class="token number">100</span>行注释掉，运行次数填写为<span class="token number">1</span>即可。

  ```python
  <span class="token keyword">import</span> os
  <span class="token keyword">import</span> shutil
  p_road <span class="token operator">=</span> <span class="token string">"D:\\Code\\Verilog\\homework_code\\P5_cpu_test"</span>
  run_time <span class="token operator">=</span> <span class="token string">"20us"</span>
  xilinx_path <span class="token operator">=</span> <span class="token string">"E:\\Xilinx\\14.7\\ISE_DS\\ISE"</span>
  error <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  
  <span class="token keyword">def</span> <span class="token function">run_mars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"编译并运行MIPS文件……"</span><span class="token punctuation">)</span>
      os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"java -jar mars.jar db mc CompactDataAtZero a dump .text HexText code.txt nc mips_code.asm"</span><span class="token punctuation">)</span>
      os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"java -jar mars.jar db mc CompactDataAtZero nc mips_code.asm &gt; mips_out.txt"</span><span class="token punctuation">)</span>
  <span class="token keyword">def</span> <span class="token function">load_hex_code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      list_temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"code.txt"</span><span class="token punctuation">,</span> <span class="token string">"r+"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> hex_code<span class="token punctuation">:</span>
          list_temp <span class="token operator">=</span> hex_code<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>p_road <span class="token operator">+</span> <span class="token string">"\\code.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> file_to_IM<span class="token punctuation">:</span>
          file_to_IM<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>list_temp<span class="token punctuation">)</span>
      hex_code<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
      file_to_IM<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
  
  
  
  <span class="token keyword">def</span> <span class="token function">run_ise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"编译并运行Verilog文件……"</span><span class="token punctuation">)</span>
      
      file_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token punctuation">,</span>k <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>p_road<span class="token punctuation">)</span><span class="token punctuation">:</span>
          <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> k<span class="token punctuation">:</span>
              <span class="token keyword">if</span> <span class="token builtin">file</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">".v"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                  file_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
  
      <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>p_road <span class="token operator">+</span> <span class="token string">"\\mips.prj"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> prj<span class="token punctuation">:</span>
          <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>file_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
              prj<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Verilog work \""</span> <span class="token operator">+</span> p_road <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\"\n"</span><span class="token punctuation">)</span>           
  
      <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>p_road <span class="token operator">+</span> <span class="token string">"\mips.tcl"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tcl<span class="token punctuation">:</span>
          tcl<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"run "</span> <span class="token operator">+</span> run_time <span class="token operator">+</span><span class="token string">";\nexit"</span><span class="token punctuation">)</span>
      
      prj<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
      tcl<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
  
      os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">"XILINX"</span><span class="token punctuation">]</span> <span class="token operator">=</span> xilinx_path
      os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>xilinx_path <span class="token operator">+</span> <span class="token string">"\\bin\\nt64\\fuse -nodebug -prj "</span> <span class="token operator">+</span> p_road <span class="token operator">+</span> <span class="token string">"\\mips.prj -o mips.exe mips_tb &gt; compile_log.txt"</span><span class="token punctuation">)</span>
      os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"mips.exe -nolog -tclbatch "</span> <span class="token operator">+</span> p_road <span class="token operator">+</span> <span class="token string">"\\mips.tcl&gt; verilog_out.txt"</span><span class="token punctuation">)</span>
      <span class="token comment"># print("mips.exe -nolog -tclbatch " + p_road + "\\mips.tcl &gt; verilog_out.txt")</span>
  
  <span class="token keyword">def</span> <span class="token function">copy_file</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> target_road<span class="token punctuation">)</span><span class="token punctuation">:</span>
      f_1 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
      list_temp <span class="token operator">=</span> f_1<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
      f_2 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>target_road <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> name<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>
      f_2<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>list_temp<span class="token punctuation">)</span>
      f_1<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
      f_2<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
  
  <span class="token keyword">def</span> <span class="token function">file_cmp</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"mips_out.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out_1<span class="token punctuation">:</span>
          out_std <span class="token operator">=</span> out_1<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
          out_std<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
          out_1<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
  
      <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"verilog_out.txt"</span><span class="token punctuation">,</span> <span class="token string">"r+"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out_2<span class="token punctuation">:</span>
          out_test <span class="token operator">=</span> out_2<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
          <span class="token comment"># out_2.truncate()</span>
          <span class="token comment"># out_2.writelines(out_test)</span>
          out_2<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
      
      flag <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">".\\log.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> log<span class="token punctuation">:</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>out_std<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>out_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
              flag <span class="token operator">=</span> <span class="token number">1</span>
              log<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Too few output! Expected output-lines is {}\nBut your output-lines is {}\n\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>out_std<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>out_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token keyword">else</span><span class="token punctuation">:</span>
              <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>out_std<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                  <span class="token keyword">if</span><span class="token punctuation">(</span>out_std<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> out_test<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>out_test<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"@"</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                      flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                      log<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Error in line {}\nExpected output is \"{}\"\nBut your outout is \"{}\"\n\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> out_std<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> out_test<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  
      log<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
  
      <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">:</span>
          <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试结果:  Failed!"</span><span class="token punctuation">)</span>
          os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">".\\test_log_file\\log_{}\\"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span>
          copy_file<span class="token punctuation">(</span><span class="token string">"log.txt"</span><span class="token punctuation">,</span> <span class="token string">".\\test_log_file\\log_{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span>
          copy_file<span class="token punctuation">(</span><span class="token string">"mips_code.asm"</span><span class="token punctuation">,</span> <span class="token string">".\\test_log_file\\log_{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span>
          copy_file<span class="token punctuation">(</span><span class="token string">"mips_out.txt"</span><span class="token punctuation">,</span> <span class="token string">".\\test_log_file\\log_{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span>
          copy_file<span class="token punctuation">(</span><span class="token string">"verilog_out.txt"</span><span class="token punctuation">,</span> <span class="token string">".\\test_log_file\\log_{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">else</span><span class="token punctuation">:</span>
          <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试结果:  Accepted!"</span><span class="token punctuation">)</span>
  
  
  
  
  test_times <span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请输入测试次数："</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"错误日志文件夹已创建！"</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">".\\test_log_file"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      shutil<span class="token punctuation">.</span>rmtree<span class="token punctuation">(</span><span class="token string">".\\test_log_file"</span><span class="token punctuation">)</span> 
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试开始！\n"</span><span class="token punctuation">)</span>
  
  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>test_times <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"python generate_2.py"</span><span class="token punctuation">)</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n测试进度:  {}/{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> test_times<span class="token punctuation">)</span><span class="token punctuation">)</span>
      run_mars<span class="token punctuation">(</span><span class="token punctuation">)</span>
      load_hex_code<span class="token punctuation">(</span><span class="token punctuation">)</span>
      run_ise<span class="token punctuation">(</span><span class="token punctuation">)</span>
      file_cmp<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  
  
  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<hr>
<h2 id="思考题">思考题</h2>
<h3 id="流水线冒险">流水线冒险</h3>
<ol>
<li>
<p><strong>在采用本节所述的控制冒险处理方式下，PC 的值应当如何被更新？请从数据通路和控制信号两方面进行说明。</strong></p>
<p><strong>A</strong>：当需要进行暂停时，IFU的使能信号失效，PC值不变。当不需要进行分支转移和跳转时，NPC中将F_pc信号加4处理返回IFU，下一时钟沿来临时更新为F_pc+4。当执行分支指令时，NPC将D_pc +4和符号扩展后的imm16相加，返回IFU，下一时钟沿上升时更新。当执行j/jal指令时，NPC将imm26进行扩展（前四位补D_pc的前四位，后两位补0），返回IFU，下一时钟沿上升时更新。当执行jr指令时，NPC将从GRF的RD1端口（考虑转发）输出的值输出，返回IFU下一时钟沿上升时更新。</p>
</li>
<li>
<p><strong>对于 jal 等需要将指令地址写入寄存器的指令，为什么需要回写 PC+8 ？</strong></p>
<p><strong>A</strong>：因为需要考虑编译优化，jal的下一条指令是延迟槽中的指令，在jal执行前会被执行。如果回写PC+4的话，当出现“jr $ra”时，将会回到延迟槽，重复执行延迟槽中的指令。因此需要回写PC+8。</p>
</li>
</ol>
<h3 id="数据冒险的分析">数据冒险的分析</h3>
<ol>
<li>
<p><strong>为什么所有的供给者都是存储了上一级传来的各种数据的流水级寄存器，而不是由 ALU 或者 DM 等部件来提供数据？</strong></p>
<p><strong>A</strong>：因为流水寄存器中的储存的数据时前一级已经计算出来的数据，在当前周期内时稳定输出的。而功能部件的输出是有延迟的，如果让这些部件提供数据，有可能再其在回写数据生成前就写入了错误的数据，导致数据波动。</p>
</li>
</ol>
<h3 id="AT-法处理流水线数据冒险">AT 法处理流水线数据冒险</h3>
<ol>
<li>
<p><strong>“转发（旁路）机制的构造”中的 Thinking 1-4；</strong></p>
<p><strong>Thinking 1</strong>：如果不采用已经转发过的数据，而采用上一级中的原始数据，会出现怎样的问题？试列举指令序列说明这个问题。</p>
<p><strong>A</strong>：例如：</p>
<pre class="line-numbers language-none"><code class="language-none">$s0, $0, 4
andi	$s1, $s0, 5
sw      $s1, 4($s0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>Thinking 2</strong>：我们为什么要对 GPR 采用内部转发机制？如果不采用内部转发机制，我们要怎样才能解决这种情况下的转发需求呢？</p>
<p><strong>A</strong>：因为需要使得W级保存的将要写入得数据及时反馈到GRF的输出端口，从而规避数据冒险。如果不采用内部转发，我们可以在GRF的输出端口加入多路选择器，将W级的数据进行转发。</p>
<p><strong>Thinking 3</strong>：为什么 0 号寄存器需要特殊处理？</p>
<p><strong>A</strong>：因为对0号寄存器的写入是无效的，如果不特殊处理，则会使得向0号寄存器写入的数据（无效输入）被错误转发，从而造成BUG。</p>
<p><strong>Thinking 4</strong>：什么是“最新产生的数据”？</p>
<p><strong>A</strong>: 距离当前需求者最近的流水寄存器中储存的数据。</p>
</li>
<li>
<p><strong>在 AT 方法讨论转发条件的时候，只提到了“供给者需求者的A相同，且不为 0”，但在 CPU 写入 GRF 的时候，是有一个 we 信号来控制是否要写入的。为何在 AT 方法中不需要特判 we 呢？为了用且仅用 A 和 T 完成转发，在翻译出 A 的时候，要结合 we 做什么操作呢？</strong></p>
<p><strong>A</strong>： 因为当we信号为0时我们就把RF写入地址置为0，因此如果“供给者的A不为0”，就已经排除了“写入信号为0”的情况。</p>
</li>
</ol>
<h3 id="在线测试相关说明">在线测试相关说明</h3>
<p>在本实验中你遇到了哪些不同指令类型组合产生的冲突？你又是如何解决的？相应的测试样例是什么样的？</p>
<p>如果你是手动构造的样例，请说明构造策略，说明你的测试程序如何保证<strong>覆盖</strong>了所有需要测试的情况；如果你是<strong>完全随机</strong>生成的测试样例，请思考完全随机的测试程序有何不足之处；如果你在生成测试样例时采用了<strong>特殊的策略，<strong>比如构造连续数据冒险序列，请你描述一下你使用的策略如何</strong>结合了随机性</strong>达到强测的效果。</p>
<p>此思考题请同学们结合自己测试 CPU 使用的具体手段，按照自己的实际情况进行回答。</p>
<p><strong>A</strong>：我是采用半随机生成半手动构造的方法。对于功能型指令，完全通过python脚本自动生成。并且为了提高数据冲突的概率，我们仅仅使用0~7号寄存器进行测试。对于跳转指令，我们先使用一定模板进行构建，然后为了增加数据冒险和控制冒险，我们又手动进行一定修改，使得测试样例尽可能更多的覆盖所有可能的情况</p>
<hr>
<h2 id="附录">附录</h2>
<p><img src="RTL%E7%BB%BC%E5%90%88%E8%A1%A8.png" alt=""></p>
<p><img src="pipline.jpg" alt=""></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Hyggge</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://hyggge.github.io/2021/11/15/co/co-p5-liu-shui-xian-cpu-basic/">http://hyggge.github.io/2021/11/15/co/co-p5-liu-shui-xian-cpu-basic/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Hyggge</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">
                                    <span class="chip bg-color">计算机组成</span>
                                </a>
                            
                                <a href="/tags/BUAA/">
                                    <span class="chip bg-color">BUAA</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/11/26/co/co-p6-liu-shui-xian-cpu-plus/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/9.jpg" class="responsive-img" alt="「BUAA-CO」P6_流水线cpu（Plus）">
                        
                        <span class="card-title">「BUAA-CO」P6_流水线cpu（Plus）</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-11-26
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/" class="post-category">
                                    计算机组成
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">
                        <span class="chip bg-color">计算机组成</span>
                    </a>
                    
                    <a href="/tags/BUAA/">
                        <span class="chip bg-color">BUAA</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/11/09/co/co-p4-dan-zhou-qi-cpu-verilog-shi-xian/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/5.jpg" class="responsive-img" alt="「BUAA-CO」P4_单周期cpu（Verilog实现）">
                        
                        <span class="card-title">「BUAA-CO」P4_单周期cpu（Verilog实现）</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-11-09
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/" class="post-category">
                                    计算机组成
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">
                        <span class="chip bg-color">计算机组成</span>
                    </a>
                    
                    <a href="/tags/BUAA/">
                        <span class="chip bg-color">BUAA</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
    });
</script>



    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">Hyggge</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
                <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" href="javascript:translatePage();">繁</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">161.1k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/hyggge" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:hyggge6@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1695386157" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1695386157" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        <script type="text/javascript" src="/js/tw_cn.js"></script>
        <script type="text/javascript">
          var defaultEncoding = 2; //网站编写字体是否繁体，1-繁体，2-简体
          var translateDelay = 0; //延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0
          var cookieDomain = "http://hyggge.github.io"; //Cookie地址, 一定要设定, 通常为你的网址
          var msgToTraditionalChinese = "繁"; //此处可以更改为你想要显示的文字
          var msgToSimplifiedChinese = "简"; //同上，但两处均不建议更改
          var translateButtonId = "translateLink"; //默认互换id
          translateInitilization();
        </script>
    
    
    

    <!-- 雪花特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>');
            }
        </script>
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
